/*
evaluatePassword v1.0.0
Author: taknakamu
Git: https://github.com/taknakamu/evaluate-password

Copyright (c) 2013 Kosuke Nakamuta
Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
*/
(function(a){a.fn.extend({evaluatePassword:function(b){var f={minimum_length:8,runOnInit:true,autoCreateForm:false,dictionaryCheck:true,dictionaryJsonPath:"../dictionary.json",requireStringKind:1,levels:{"0":"短すぎます","1":"低","2":"中","3":"良好","4":"高"},patterns:["[a-z]","[A-Z]","[0-9]","-_"]};b=a.extend(f,b);if(b.dictionaryCheck){if(!a.evaluate_password){a.getJSON(b.dictionaryJsonPath,function(g){a.extend({evaluate_password:{dictionaly:g}})})}}var e=a("[data-target="+a(this).attr("id")+"]");if(b.autoCreateForm){c()}function c(){e.append(a("<b/>").text("パスワードの安全度：")).append(a("<span/>").addClass("password-status")).append(a("<div/>").addClass("password-bar").append(a("<div/>").addClass("password-level")))}function d(){var i=a(this).val();var l=i.length;var j=a(this).attr("id");var n=e.find(".password-status");var g=e.find("[class^=password-level]");var h=0;g.removeClass();if(l<b.minimum_length){h=0}else{if(b.minimum_length<=l&&l<=10){h=1}else{if(11<=l){h=2}}var o={};a(i.split("")).each(function(q,p){o[p]=1});var m=0;a.each(o,function(){m++});if(m<=1){if(i.match(/a|q|z|o|m|[0-9]/)&&h===2&&12<=l&&l<=18){if(l%2===1){h--}}}else{if(m<=4){h++}else{if(5<=m){h+=2}}}var k=0;a.each(b.patterns,function(q,p){if(i.match(new RegExp(p))){k++}});if(k<b.requireStringKind){h=1}if(b.dictionaryCheck&&a.evaluate_password){a.each(a.evaluate_password.dictionaly,function(q,p){if(i.match(new RegExp(p))&&i.length<17){if(""===i.replace(new RegExp(p,"g"),"")){h=1}}})}}n.text(b.levels[h]);g.addClass("password-level"+h);a(this)[0].level=h}if(b.runOnInit){this.each(function(){return d.apply(this)})}return this.each(function(){a(this).bind("keyup focus",d)})}})})(jQuery);